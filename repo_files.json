{
  "main.py": {
    "summary": "This file is the entry point for an application that initializes and runs an instance of the `OperonUI` class, which is part of a TUI (Text User Interface) module.",
    "functions": [],
    "classes": [],
    "imports": [
      "sys",
      "OperonUI"
    ]
  },
  "readme.md": {
    "summary": "This file is the README for Operon, a local-first autonomous coding agent designed to modify repository functions using deterministic loop control, slice-based rewriting, and human-approved commits.",
    "functions": [],
    "classes": [],
    "imports": [
      "in"
    ]
  },
  "repo_tree.json": {
    "summary": "This file represents the structure of a repository, listing all files and directories within it.",
    "functions": [],
    "classes": [],
    "imports": []
  },
  "repo_files.json": {
    "summary": "This file describes the structure and contents of a software repository, including Python scripts with functions and classes for various tasks like running tests, applying patches, searching repositories, and building a brain for the repo using an LLM.",
    "functions": [],
    "classes": [],
    "imports": []
  },
  "tools/function_locator.py": {
    "summary": "This file defines a function `find_function` that searches a JSON file containing repository information for a specific function or class by name and returns its file path and line range.",
    "functions": [
      {
        "name": "find_function",
        "start": 5,
        "end": 39
      }
    ],
    "classes": [],
    "imports": [
      "json",
      "Path"
    ]
  },
  "tools/fs_tools.py": {
    "summary": "This file provides functions to read from and write to files, returning detailed success or error information.",
    "functions": [
      {
        "name": "read_file",
        "start": 5,
        "end": 11
      },
      {
        "name": "write_file",
        "start": 13,
        "end": 39
      }
    ],
    "classes": [],
    "imports": [
      "Path",
      "Dict"
    ]
  },
  "tools/git_tools.py": {
    "summary": "This file contains functions to interact with Git repositories, including running Git commands, creating branches, and committing changes with automated messages.",
    "functions": [
      {
        "name": "_run",
        "start": 6,
        "end": 18
      },
      {
        "name": "_current_branch",
        "start": 21,
        "end": 23
      },
      {
        "name": "_slugify",
        "start": 26,
        "end": 30
      },
      {
        "name": "smart_commit_pipeline",
        "start": 33,
        "end": 51
      }
    ],
    "classes": [],
    "imports": [
      "subprocess",
      "re",
      "log"
    ]
  },
  "tools/diff_engine.py": {
    "summary": "This file contains functions to parse search and replace blocks from text, normalize lines for comparison, and apply patches to original text by replacing matching blocks while handling indentation differences.",
    "functions": [
      {
        "name": "parse_search_replace",
        "start": 3,
        "end": 10
      },
      {
        "name": "_normalize_lines",
        "start": 12,
        "end": 14
      },
      {
        "name": "apply_patch",
        "start": 16,
        "end": 72
      }
    ],
    "classes": [],
    "imports": [
      "re"
    ]
  },
  "tools/build_brain.py": {
    "summary": "This file initializes the repository brain by calling the `build_repo_brain` function from the `tools.repo_brain` module and passing the path to the repository and a language model call function from the `agent.llm` module.",
    "functions": [],
    "classes": [],
    "imports": [
      "build_repo_brain",
      "call_llm"
    ]
  },
  "tools/repo_search.py": {
    "summary": "This file defines a function `search_repo` that searches a repository for files containing specific keywords, scoring them based on the number of unique keywords found, and returns the top 5 highest-scoring files.",
    "functions": [
      {
        "name": "search_repo",
        "start": 4,
        "end": 39
      }
    ],
    "classes": [],
    "imports": [
      "json",
      "Path"
    ]
  },
  "tools/repo_brain.py": {
    "summary": "Provides functions build_tree, extract_python_info, build_repo_brain, extract_python_structure_ast, Visitor.visit_FunctionDef and classes Visitor.",
    "functions": [
      {
        "name": "build_tree",
        "start": 12,
        "end": 25
      },
      {
        "name": "extract_python_info",
        "start": 28,
        "end": 34
      },
      {
        "name": "build_repo_brain",
        "start": 36,
        "end": 119
      },
      {
        "name": "extract_python_structure_ast",
        "start": 121,
        "end": 171
      },
      {
        "name": "Visitor.visit_FunctionDef",
        "start": 135,
        "end": 141
      },
      {
        "name": "Visitor.visit_AsyncFunctionDef",
        "start": 143,
        "end": 149
      },
      {
        "name": "Visitor.visit_ClassDef",
        "start": 151,
        "end": 167
      },
      {
        "name": "visit_FunctionDef",
        "start": 135,
        "end": 141
      },
      {
        "name": "visit_AsyncFunctionDef",
        "start": 143,
        "end": 149
      },
      {
        "name": "visit_ClassDef",
        "start": 151,
        "end": 167
      }
    ],
    "classes": [
      {
        "name": "Visitor",
        "start": 133,
        "end": 167
      }
    ],
    "imports": [
      "Path",
      "json",
      "re",
      "ast"
    ]
  },
  "tools/code_slice.py": {
    "summary": "This file defines a function `load_function_slice` that loads and returns the code snippet surrounding a specified function or class within a given repository.",
    "functions": [
      {
        "name": "load_function_slice",
        "start": 5,
        "end": 47
      }
    ],
    "classes": [],
    "imports": [
      "Path",
      "find_function"
    ]
  },
  "agent/tool_jail.py": {
    "summary": "This file defines a set of allowed actions for an agent, including searching a repository, reading a file, rewriting a function in a file, and finishing with a message.",
    "functions": [],
    "classes": [],
    "imports": []
  },
  "agent/decide.py": {
    "summary": "This file contains a function `decide_next_action` that uses a language model to determine the next action to take based on the current state, including action history, observations, and a goal. It outputs a JSON object with a thought process and a tool to be executed.",
    "functions": [
      {
        "name": "decide_next_action",
        "start": 6,
        "end": 70
      }
    ],
    "classes": [],
    "imports": [
      "json",
      "re",
      "call_llm",
      "log"
    ]
  },
  "agent/planner.py": {
    "summary": "This file defines a function `make_plan` that generates a list of high-level steps to achieve a given goal using a language model.",
    "functions": [
      {
        "name": "make_plan",
        "start": 4,
        "end": 36
      }
    ],
    "classes": [],
    "imports": [
      "call_llm"
    ]
  },
  "agent/approval.py": {
    "summary": "This file contains a function `ask_user_approval` that pauses a worker thread, displays an approval dialogue, and waits for user input to either approve or reject a code change.",
    "functions": [
      {
        "name": "ask_user_approval",
        "start": 3,
        "end": 28
      }
    ],
    "classes": [],
    "imports": [
      "agent.logger"
    ]
  },
  "agent/logger.py": {
    "summary": "This file defines a custom logging handler for a UI-based application, allowing logs to be displayed both in a file and through a user interface.",
    "functions": [
      {
        "name": "TUILogHandler.emit",
        "start": 11,
        "end": 16
      },
      {
        "name": "emit",
        "start": 11,
        "end": 16
      },
      {
        "name": "setup_logger",
        "start": 18,
        "end": 34
      }
    ],
    "classes": [
      {
        "name": "TUILogHandler",
        "start": 10,
        "end": 16
      }
    ],
    "imports": [
      "logging",
      "sys",
      "queue"
    ]
  },
  "agent/loop.py": {
    "summary": "This file contains functions for detecting functions from a goal, rewriting functions based on a state and code to modify, and running an agent to perform these tasks.",
    "functions": [
      {
        "name": "_detect_function_from_goal",
        "start": 18,
        "end": 25
      },
      {
        "name": "_rewrite_function",
        "start": 27,
        "end": 117
      },
      {
        "name": "run_agent",
        "start": 120,
        "end": 293
      }
    ],
    "classes": [],
    "imports": [
      "search_repo",
      "ask_user_approval",
      "decide_next_action",
      "make_plan",
      "log",
      "read_file",
      "find_function",
      "load_function_slice",
      "call_llm",
      "Path",
      "agent.logger",
      "ast",
      "time",
      "re",
      "Path",
      "parse_search_replace",
      "ask_user_approval",
      "AND",
      "ALLOWED_ACTIONS",
      "time",
      "Path",
      "smart_commit_pipeline"
    ]
  },
  "agent/llm.py": {
    "summary": "This file contains a function `call_llm` that sends a prompt to a local language model server and returns the response.",
    "functions": [
      {
        "name": "call_llm",
        "start": 10,
        "end": 42
      }
    ],
    "classes": [],
    "imports": [
      "requests",
      "json",
      "log"
    ]
  },
  "agent/repo.py": {
    "summary": "This file defines a function `build_repo_summary` that takes a repository root directory and an optional maximum number of files to list, then returns a string containing the paths of up to that many files in the repository, excluding files in the `.git` directory.",
    "functions": [
      {
        "name": "build_repo_summary",
        "start": 3,
        "end": 13
      }
    ],
    "classes": [],
    "imports": [
      "Path"
    ]
  },
  "tui/app.py": {
    "summary": "This file defines a text-based user interface (TUI) for an application called Operon, which includes features for displaying and approving code changes.",
    "functions": [
      {
        "name": "DiffApproval.__init__",
        "start": 18,
        "end": 22
      },
      {
        "name": "DiffApproval.compose",
        "start": 24,
        "end": 30
      },
      {
        "name": "DiffApproval.on_mount",
        "start": 32,
        "end": 40
      },
      {
        "name": "DiffApproval.on_button_pressed",
        "start": 42,
        "end": 47
      },
      {
        "name": "__init__",
        "start": 18,
        "end": 22
      },
      {
        "name": "compose",
        "start": 24,
        "end": 30
      },
      {
        "name": "on_mount",
        "start": 32,
        "end": 40
      },
      {
        "name": "on_button_pressed",
        "start": 42,
        "end": 47
      },
      {
        "name": "OperonUI.compose",
        "start": 66,
        "end": 74
      },
      {
        "name": "OperonUI.on_mount",
        "start": 76,
        "end": 84
      },
      {
        "name": "OperonUI.on_key",
        "start": 86,
        "end": 94
      },
      {
        "name": "OperonUI.on_input_submitted",
        "start": 96,
        "end": 109
      },
      {
        "name": "OperonUI.execute_agent",
        "start": 111,
        "end": 115
      },
      {
        "name": "OperonUI.safe_update_log",
        "start": 117,
        "end": 118
      },
      {
        "name": "OperonUI._write_to_log",
        "start": 120,
        "end": 121
      },
      {
        "name": "OperonUI.safe_show_diff",
        "start": 123,
        "end": 124
      },
      {
        "name": "OperonUI._render_approval_ui",
        "start": 126,
        "end": 134
      },
      {
        "name": "OperonUI.resolve_approval",
        "start": 136,
        "end": 150
      },
      {
        "name": "compose",
        "start": 66,
        "end": 74
      },
      {
        "name": "on_mount",
        "start": 76,
        "end": 84
      },
      {
        "name": "on_key",
        "start": 86,
        "end": 94
      },
      {
        "name": "on_input_submitted",
        "start": 96,
        "end": 109
      },
      {
        "name": "execute_agent",
        "start": 111,
        "end": 115
      },
      {
        "name": "safe_update_log",
        "start": 117,
        "end": 118
      },
      {
        "name": "_write_to_log",
        "start": 120,
        "end": 121
      },
      {
        "name": "safe_show_diff",
        "start": 123,
        "end": 124
      },
      {
        "name": "_render_approval_ui",
        "start": 126,
        "end": 134
      },
      {
        "name": "resolve_approval",
        "start": 136,
        "end": 150
      }
    ],
    "classes": [
      {
        "name": "DiffApproval",
        "start": 16,
        "end": 47
      },
      {
        "name": "OperonUI",
        "start": 49,
        "end": 150
      }
    ],
    "imports": [
      "os",
      "sys",
      "App",
      "Horizontal",
      "Header",
      "Key",
      "Text",
      "Panel",
      "Group",
      "Syntax",
      "cast",
      "AgentState",
      "run_agent",
      "agent.logger"
    ]
  },
  "runtime/state.py": {
    "summary": "This file defines a data class `AgentState` that holds various attributes representing the state of an agent, including its goal, repository root, plan, files read and modified, last action, action log, observations, errors, step count, and whether the task is done.",
    "functions": [],
    "classes": [
      {
        "name": "AgentState",
        "start": 5,
        "end": 20
      }
    ],
    "imports": [
      "dataclass",
      "List"
    ]
  }
}