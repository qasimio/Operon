{
  "main.py": {
    "summary": "This file is the main entry point for an application that uses the `OperonUI` class from the `tui.app` module to create and run a user interface.",
    "functions": [],
    "classes": [],
    "imports": [
      "OperonUI",
      "sys",
      "tui.app"
    ]
  },
  "requirements.txt": {
    "summary": "This file lists the Python packages and their versions required for a project.",
    "functions": [],
    "classes": [],
    "imports": []
  },
  "print.js": {
    "summary": "This file prints the numbers 1 through 10 to the console.",
    "functions": [],
    "classes": [],
    "imports": []
  },
  "readme.md": {
    "summary": "This file is the README for Operon, an advanced AI software engineer designed to navigate local repositories, reason about code, perform surgical file edits, verify its work, and commit changes through a text user interface-driven local CLI agent.",
    "functions": [],
    "classes": [],
    "imports": [
      "json",
      "os",
      "to"
    ]
  },
  "repo_tree.json": {
    "summary": "This file represents the directory structure of a software project, listing all files and subdirectories.",
    "functions": [],
    "classes": [],
    "imports": []
  },
  "repo_files.json": {
    "summary": "This file describes the structure and contents of a software repository, including Python scripts with functions and classes for various tasks like running tests, applying patches, searching repositories, and building a brain for the repo using an LLM.",
    "functions": [],
    "classes": [],
    "imports": []
  },
  "tools/function_locator.py": {
    "summary": "This file defines a function `find_function` that searches for a function or class by name within a repository, returning the file path and line range if found.",
    "functions": [
      {
        "name": "find_function",
        "start": 5,
        "end": 39
      }
    ],
    "classes": [],
    "imports": [
      "Path",
      "json",
      "pathlib"
    ]
  },
  "tools/universal_parser.py": {
    "summary": "This file provides functions to parse, check syntax, and extract symbols (functions and classes) from code in various programming languages using the Tree-sitter library.",
    "functions": [
      {
        "name": "get_parser",
        "start": 18,
        "end": 25
      },
      {
        "name": "check_syntax",
        "start": 28,
        "end": 35
      },
      {
        "name": "extract_symbols",
        "start": 38,
        "end": 97
      },
      {
        "name": "get_node_name",
        "start": 65,
        "end": 76
      },
      {
        "name": "walk",
        "start": 78,
        "end": 94
      }
    ],
    "classes": [],
    "imports": [
      "Language",
      "Path",
      "pathlib",
      "tree_sitter",
      "tree_sitter_java",
      "tree_sitter_javascript",
      "tree_sitter_python"
    ]
  },
  "tools/fs_tools.py": {
    "summary": "This file provides functions to read from and write to files, handling paths relative to a repository root and providing detailed success or error responses.",
    "functions": [
      {
        "name": "read_file",
        "start": 4,
        "end": 10
      },
      {
        "name": "write_file",
        "start": 12,
        "end": 38
      }
    ],
    "classes": [],
    "imports": [
      "Dict",
      "Path",
      "pathlib",
      "typing"
    ]
  },
  "tools/diff_engine.py": {
    "summary": "This file contains functions to parse search and replace blocks from LLM output, normalize lines for comparison, and apply patches to original text by matching and replacing blocks while handling indentation and new file creation.",
    "functions": [
      {
        "name": "parse_search_replace",
        "start": 3,
        "end": 10
      },
      {
        "name": "_normalize_lines",
        "start": 12,
        "end": 14
      },
      {
        "name": "apply_patch",
        "start": 16,
        "end": 78
      }
    ],
    "classes": [],
    "imports": [
      "re"
    ]
  },
  "tools/git_safety.py": {
    "summary": "This file contains functions to safely run Git commands, set up a Git environment, rollback changes in case of failure, and commit successful work with a specific message prefix.",
    "functions": [
      {
        "name": "run_git",
        "start": 6,
        "end": 12
      },
      {
        "name": "setup_git_env",
        "start": 14,
        "end": 38
      },
      {
        "name": "rollback_macro",
        "start": 40,
        "end": 58
      },
      {
        "name": "commit_success",
        "start": 60,
        "end": 75
      }
    ],
    "classes": [],
    "imports": [
      "agent.logger",
      "log",
      "subprocess",
      "uuid"
    ]
  },
  "tools/repo_index.py": {
    "summary": "This file builds a 4-level intelligence index for a repository, including semantic search, symbol index, dependency graph, and AST extraction.",
    "functions": [
      {
        "name": "build_symbol_index",
        "start": 34,
        "end": 59
      },
      {
        "name": "_extract_raw_imports",
        "start": 74,
        "end": 78
      },
      {
        "name": "_module_to_path",
        "start": 81,
        "end": 99
      },
      {
        "name": "build_dep_graph",
        "start": 102,
        "end": 129
      },
      {
        "name": "build_ast_cache",
        "start": 136,
        "end": 167
      },
      {
        "name": "build_full_index",
        "start": 174,
        "end": 216
      },
      {
        "name": "get_relevant_context",
        "start": 219,
        "end": 258
      }
    ],
    "classes": [],
    "imports": [
      "Dict",
      "Path",
      "__future__",
      "agent.logger",
      "annotations",
      "extract_symbols",
      "json",
      "log",
      "pathlib",
      "re",
      "resolution",
      "tools.universal_parser",
      "typing"
    ]
  },
  "tools/build_brain.py": {
    "summary": "This file initializes a repository brain by calling a function from another module.",
    "functions": [],
    "classes": [],
    "imports": [
      "agent.llm",
      "build_repo_brain",
      "call_llm",
      "tools.repo_brain"
    ]
  },
  "tools/repo_search.py": {
    "summary": "This file contains a function `search_repo` that performs a semantic search on a codebase using LanceDB and FastEmbed, logging the search query and returning the top 5 hits.",
    "functions": [
      {
        "name": "search_repo",
        "start": 5,
        "end": 12
      }
    ],
    "classes": [],
    "imports": [
      "agent.logger",
      "log",
      "search_memory",
      "tools.semantic_memory"
    ]
  },
  "tools/repo_brain.py": {
    "summary": "This file is a script that builds a \"repo brain\" for a given repository, which includes a tree of the repository's files, a summary of each file, and information about the functions, classes, and imports in each file.",
    "functions": [
      {
        "name": "build_tree",
        "start": 12,
        "end": 21
      },
      {
        "name": "extract_imports_regex",
        "start": 24,
        "end": 34
      },
      {
        "name": "build_repo_brain",
        "start": 37,
        "end": 116
      }
    ],
    "classes": [],
    "imports": [
      "Path",
      "detection.",
      "extract_symbols",
      "json",
      "pathlib",
      "re",
      "tools.universal_parser"
    ]
  },
  "tools/diff_report.py": {
    "summary": "This file contains functions to generate a human-readable diff report from JSON data or a repository.",
    "functions": [
      {
        "name": "dump_diff_report_from_json",
        "start": 5,
        "end": 28
      },
      {
        "name": "dump_diff_report_from_repo",
        "start": 29,
        "end": 31
      }
    ],
    "classes": [],
    "imports": [
      "Path",
      "datetime",
      "json",
      "pathlib"
    ]
  },
  "tools/code_slice.py": {
    "summary": "This file defines a function `load_function_slice` that loads and returns the lines of code surrounding a specified function or class within a repository.",
    "functions": [
      {
        "name": "load_function_slice",
        "start": 5,
        "end": 47
      }
    ],
    "classes": [],
    "imports": [
      "Path",
      "find_function",
      "pathlib",
      "tools.function_locator"
    ]
  },
  "tools/semantic_memory.py": {
    "summary": "This file contains functions to index and search a code repository using semantic embeddings, allowing for efficient code retrieval based on content similarity.",
    "functions": [
      {
        "name": "get_db_path",
        "start": 14,
        "end": 17
      },
      {
        "name": "_hash_file",
        "start": 19,
        "end": 23
      },
      {
        "name": "index_repo",
        "start": 25,
        "end": 91
      },
      {
        "name": "search_memory",
        "start": 93,
        "end": 113
      }
    ],
    "classes": [],
    "imports": [
      "Path",
      "TextEmbedding",
      "agent.logger",
      "extract_symbols",
      "fastembed",
      "hashlib",
      "lancedb",
      "log",
      "os",
      "pathlib",
      "pyarrow",
      "tools.universal_parser"
    ]
  },
  "agent/tool_jail.py": {
    "summary": "This file contains a function `validate_tool` that checks if a given action and its payload are allowed based on the current phase (CODER or REVIEWER) and performs additional checks like parameter presence and throttling.",
    "functions": [
      {
        "name": "validate_tool",
        "start": 22,
        "end": 64
      }
    ],
    "classes": [],
    "imports": []
  },
  "agent/decide.py": {
    "summary": "This file contains functions to verify code changes, including a structural diff verification that uses an LLM to assess whether changes satisfy current milestones.",
    "functions": [
      {
        "name": "structural_diff_verify",
        "start": 17,
        "end": 82
      },
      {
        "name": "_run_validator",
        "start": 85,
        "end": 150
      },
      {
        "name": "decide_next_action",
        "start": 153,
        "end": 280
      }
    ],
    "classes": [],
    "imports": [
      "Path",
      "agent.llm",
      "agent.logger",
      "call_llm",
      "difflib",
      "json",
      "log",
      "pathlib",
      "re"
    ]
  },
  "agent/planner.py": {
    "summary": "This file contains a function `make_plan` that generates a coding plan based on a given goal and optionally uses a 4-level index for richer context.",
    "functions": [
      {
        "name": "make_plan",
        "start": 8,
        "end": 81
      }
    ],
    "classes": [],
    "imports": [
      "agent.llm",
      "agent.logger",
      "call_llm",
      "json",
      "log",
      "re"
    ]
  },
  "agent/approval.py": {
    "summary": "This file contains a function `ask_user_approval` that pauses a worker thread, displays an approval dialogue, and waits for user input to either approve or reject a code change.",
    "functions": [
      {
        "name": "ask_user_approval",
        "start": 3,
        "end": 28
      }
    ],
    "classes": [],
    "imports": [
      "agent.logger"
    ]
  },
  "agent/validators.py": {
    "summary": "This file contains a function `validate_step` that checks if a code change satisfies a given goal, using multiple tiers of validation including custom validators, structural checks, token presence, diff significance, and line count verification.",
    "functions": [
      {
        "name": "validate_step",
        "start": 8,
        "end": 107
      }
    ],
    "classes": [],
    "imports": [
      "Optional",
      "Path",
      "difflib",
      "pathlib",
      "re",
      "typing"
    ]
  },
  "agent/logger.py": {
    "summary": "This file sets up a logging system that writes logs to both a file and a user interface, with different formatting for each.",
    "functions": [
      {
        "name": "emit",
        "start": 11,
        "end": 16
      },
      {
        "name": "setup_logger",
        "start": 18,
        "end": 34
      }
    ],
    "classes": [
      {
        "name": "TUILogHandler",
        "start": 10,
        "end": 16
      }
    ],
    "imports": [
      "logging",
      "queue",
      "sys"
    ]
  },
  "agent/loop.py": {
    "summary": "This file contains functions and logic for managing an agent's loop, including state management, goal checking, payload normalization, and repository path resolution.",
    "functions": [
      {
        "name": "_ensure_state_fields",
        "start": 27,
        "end": 41
      },
      {
        "name": "_goal_achieved",
        "start": 44,
        "end": 67
      },
      {
        "name": "canonicalize_payload",
        "start": 70,
        "end": 74
      },
      {
        "name": "normalize_action_payload",
        "start": 77,
        "end": 99
      },
      {
        "name": "resolve_repo_path",
        "start": 102,
        "end": 114
      },
      {
        "name": "is_noop_action",
        "start": 117,
        "end": 124
      },
      {
        "name": "_register_recent_action",
        "start": 127,
        "end": 132
      },
      {
        "name": "_detect_alternating_loop",
        "start": 135,
        "end": 146
      },
      {
        "name": "_increment_search_count",
        "start": 149,
        "end": 156
      },
      {
        "name": "_should_throttle_search",
        "start": 159,
        "end": 166
      },
      {
        "name": "_detect_function_from_goal",
        "start": 169,
        "end": 175
      },
      {
        "name": "_persist_diff_memory",
        "start": 178,
        "end": 196
      },
      {
        "name": "_rewrite_function",
        "start": 201,
        "end": 392
      },
      {
        "name": "run_agent",
        "start": 397,
        "end": 779
      }
    ],
    "classes": [],
    "imports": [
      "Path",
      "agent.approval",
      "agent.decide",
      "agent.llm",
      "agent.logger",
      "agent.planner",
      "agent.tool_jail",
      "agent.validators",
      "ask_user_approval",
      "build_full_index",
      "call_llm",
      "check_syntax",
      "decide_next_action",
      "difflib",
      "dump_diff_report_from_json",
      "find_function",
      "get_relevant_context",
      "json",
      "log",
      "make_plan",
      "os",
      "parse_search_replace",
      "pathlib",
      "re",
      "read_file",
      "runtime",
      "search_repo",
      "setup_git_env",
      "state",
      "time",
      "tools.diff_engine",
      "tools.diff_report",
      "tools.fs_tools",
      "tools.function_locator",
      "tools.git_safety",
      "tools.repo_index",
      "tools.repo_search",
      "tools.universal_parser",
      "validate_step",
      "validate_tool"
    ]
  },
  "agent/llm.py": {
    "summary": "This file defines functions to interact with a language model server, trimming prompts to fit context limits and handling retries for robust communication.",
    "functions": [
      {
        "name": "_trim_prompt",
        "start": 23,
        "end": 28
      },
      {
        "name": "call_llm",
        "start": 31,
        "end": 82
      }
    ],
    "classes": [],
    "imports": [
      "agent.logger",
      "json",
      "log",
      "requests",
      "time"
    ]
  },
  "agent/repo.py": {
    "summary": "This file defines a function `build_repo_summary` that generates a summary of files in a given repository, excluding files within the `.git` directory, and limits the output to a specified number of files.",
    "functions": [
      {
        "name": "build_repo_summary",
        "start": 3,
        "end": 16
      }
    ],
    "classes": [],
    "imports": [
      "Path",
      "pathlib"
    ]
  },
  "tui/app.py": {
    "summary": "This file defines a TUI (Text User Interface) application for an autonomous software engineer (SWE) tool named Operon, which allows users to interact with and manage code changes through a graphical interface.",
    "functions": [
      {
        "name": "__init__",
        "start": 21,
        "end": 25
      },
      {
        "name": "compose",
        "start": 27,
        "end": 33
      },
      {
        "name": "on_mount",
        "start": 35,
        "end": 49
      },
      {
        "name": "on_button_pressed",
        "start": 51,
        "end": 55
      },
      {
        "name": "compose",
        "start": 77,
        "end": 89
      },
      {
        "name": "on_mount",
        "start": 93,
        "end": 104
      },
      {
        "name": "_background_index",
        "start": 106,
        "end": 127
      },
      {
        "name": "on_key",
        "start": 131,
        "end": 138
      },
      {
        "name": "on_input_submitted",
        "start": 142,
        "end": 179
      },
      {
        "name": "execute_agent",
        "start": 183,
        "end": 201
      },
      {
        "name": "safe_update_log",
        "start": 205,
        "end": 206
      },
      {
        "name": "safe_show_diff",
        "start": 208,
        "end": 209
      },
      {
        "name": "_render_approval_ui",
        "start": 211,
        "end": 216
      },
      {
        "name": "resolve_approval",
        "start": 218,
        "end": 226
      }
    ],
    "classes": [
      {
        "name": "DiffApproval",
        "start": 18,
        "end": 55
      },
      {
        "name": "OperonUI",
        "start": 58,
        "end": 226
      }
    ],
    "imports": [
      "AgentState",
      "App",
      "Group",
      "Header",
      "Horizontal",
      "Key",
      "Panel",
      "Syntax",
      "agent.logger",
      "agent.loop",
      "build_full_index",
      "cast",
      "dump_diff_report_from_repo",
      "index_repo",
      "os",
      "rich.console",
      "rich.panel",
      "rich.syntax",
      "run_agent",
      "runtime.state",
      "textual.app",
      "textual.containers",
      "textual.events",
      "textual.widgets",
      "tools.diff_report",
      "tools.repo_index",
      "tools.semantic_memory",
      "typing"
    ]
  },
  ".operon/last_session_diff.txt": {
    "summary": "This file contains a diff report for changes made to the `print.js` file between two specific timestamps.",
    "functions": [],
    "classes": [],
    "imports": []
  },
  "runtime/state.py": {
    "summary": "This file defines a dataclass `AgentState` to manage the state of an agent in a multi-agent system, including its goals, current phase, plan, file tracking, action history, counters, memory, and intelligence index.",
    "functions": [],
    "classes": [
      {
        "name": "AgentState",
        "start": 7,
        "end": 55
      }
    ],
    "imports": [
      "List",
      "dataclass",
      "dataclasses",
      "typing"
    ]
  }
}