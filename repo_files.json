{
  "main.py": {
    "summary": "This file is the entry point for an application that initializes and runs an instance of `OperonUI`, a user interface component, handling graceful shutdown on keyboard interrupts.",
    "functions": [],
    "classes": [],
    "imports": [
      "OperonUI",
      "sys",
      "tui.app"
    ]
  },
  "requirements.txt": {
    "summary": "This file lists the Python packages and their versions required for a project.",
    "functions": [],
    "classes": [],
    "imports": []
  },
  "test.js": {
    "summary": "This file contains a function named `printHello` that logs the string \"hello Operon Multilingual\" to the console.",
    "functions": [
      {
        "name": "printHello",
        "start": 1,
        "end": 3
      }
    ],
    "classes": [],
    "imports": []
  },
  "readme.md": {
    "summary": "This file is the README for Operon, a local-first autonomous coding agent designed to modify repository functions using deterministic loop control, slice-based rewriting, and human-approved commits.",
    "functions": [],
    "classes": [],
    "imports": [
      "in"
    ]
  },
  "repo_tree.json": {
    "summary": "This file, `repo_tree.json`, appears to be a JSON representation of the file structure of a software repository, listing all files and directories within it.",
    "functions": [],
    "classes": [],
    "imports": []
  },
  "repo_files.json": {
    "summary": "This file describes the structure and contents of a software repository, including Python scripts with functions and classes for various tasks like running tests, applying patches, searching repositories, and building a brain for the repo using an LLM.",
    "functions": [],
    "classes": [],
    "imports": []
  },
  "tools/function_locator.py": {
    "summary": "This file defines a function `find_function` that searches for a function or class by name within a repository, returning its file path and line range if found.",
    "functions": [
      {
        "name": "find_function",
        "start": 5,
        "end": 39
      }
    ],
    "classes": [],
    "imports": [
      "Path",
      "json",
      "pathlib"
    ]
  },
  "tools/universal_parser.py": {
    "summary": "This file provides functions to parse and analyze code in multiple programming languages, including Python, JavaScript, and Java, by using the Tree-sitter library.",
    "functions": [
      {
        "name": "get_parser",
        "start": 18,
        "end": 25
      },
      {
        "name": "check_syntax",
        "start": 28,
        "end": 35
      },
      {
        "name": "extract_symbols",
        "start": 38,
        "end": 97
      },
      {
        "name": "get_node_name",
        "start": 65,
        "end": 76
      },
      {
        "name": "walk",
        "start": 78,
        "end": 94
      }
    ],
    "classes": [],
    "imports": [
      "Language",
      "Path",
      "pathlib",
      "tree_sitter",
      "tree_sitter_java",
      "tree_sitter_javascript",
      "tree_sitter_python"
    ]
  },
  "tools/fs_tools.py": {
    "summary": "This file provides functions to read from and write to files, handling paths relative to a repository root and providing detailed success or error responses.",
    "functions": [
      {
        "name": "read_file",
        "start": 5,
        "end": 11
      },
      {
        "name": "write_file",
        "start": 13,
        "end": 39
      }
    ],
    "classes": [],
    "imports": [
      "Dict",
      "Path",
      "pathlib",
      "typing"
    ]
  },
  "tools/git_tools.py": {
    "summary": "This file contains functions to interact with Git, including running Git commands, creating branches, and committing changes.",
    "functions": [
      {
        "name": "_run",
        "start": 6,
        "end": 18
      },
      {
        "name": "_current_branch",
        "start": 21,
        "end": 23
      },
      {
        "name": "_slugify",
        "start": 26,
        "end": 30
      },
      {
        "name": "smart_commit_pipeline",
        "start": 33,
        "end": 51
      }
    ],
    "classes": [],
    "imports": [
      "agent.logger",
      "log",
      "re",
      "subprocess"
    ]
  },
  "tools/diff_engine.py": {
    "summary": "This file contains functions to parse and apply patches to text, handling both exact matches and smart whitespace matching to ensure accurate updates.",
    "functions": [
      {
        "name": "parse_search_replace",
        "start": 3,
        "end": 10
      },
      {
        "name": "_normalize_lines",
        "start": 12,
        "end": 14
      },
      {
        "name": "apply_patch",
        "start": 16,
        "end": 78
      }
    ],
    "classes": [],
    "imports": [
      "re"
    ]
  },
  "tools/build_brain.py": {
    "summary": "This file initializes a repository brain by calling a function from the `tools.repo_brain` module and passing a directory path and a language model function as arguments.",
    "functions": [],
    "classes": [],
    "imports": [
      "agent.llm",
      "build_repo_brain",
      "call_llm",
      "tools.repo_brain"
    ]
  },
  "tools/repo_search.py": {
    "summary": "This file contains a function `search_repo` that performs a semantic search on a codebase using LanceDB and FastEmbed, logging the search query and returning the top 5 hits.",
    "functions": [
      {
        "name": "search_repo",
        "start": 5,
        "end": 12
      }
    ],
    "classes": [],
    "imports": [
      "agent.logger",
      "log",
      "search_memory",
      "tools.semantic_memory"
    ]
  },
  "tools/repo_brain.py": {
    "summary": "This file, `repo_brain.py`, is a script that analyzes a repository by building a tree of its files, extracting symbols and imports from each file, and summarizing the content using a language model. It then saves this information in JSON files named `repo_tree.json` and `repo_files.json`.",
    "functions": [
      {
        "name": "build_tree",
        "start": 12,
        "end": 21
      },
      {
        "name": "extract_imports_regex",
        "start": 24,
        "end": 34
      },
      {
        "name": "build_repo_brain",
        "start": 37,
        "end": 116
      }
    ],
    "classes": [],
    "imports": [
      "Path",
      "detection.",
      "extract_symbols",
      "json",
      "pathlib",
      "re",
      "tools.universal_parser"
    ]
  },
  "tools/code_slice.py": {
    "summary": "This file defines a function `load_function_slice` that loads and returns the code snippet surrounding a specified function or class within a repository.",
    "functions": [
      {
        "name": "load_function_slice",
        "start": 5,
        "end": 47
      }
    ],
    "classes": [],
    "imports": [
      "Path",
      "find_function",
      "pathlib",
      "tools.function_locator"
    ]
  },
  "tools/semantic_memory.py": {
    "summary": "This file contains functions to index and search a code repository using semantic embeddings, allowing for efficient code retrieval based on content similarity.",
    "functions": [
      {
        "name": "get_db_path",
        "start": 14,
        "end": 17
      },
      {
        "name": "_hash_file",
        "start": 19,
        "end": 23
      },
      {
        "name": "index_repo",
        "start": 25,
        "end": 91
      },
      {
        "name": "search_memory",
        "start": 93,
        "end": 113
      }
    ],
    "classes": [],
    "imports": [
      "Path",
      "TextEmbedding",
      "agent.logger",
      "extract_symbols",
      "fastembed",
      "hashlib",
      "lancedb",
      "log",
      "os",
      "pathlib",
      "pyarrow",
      "tools.universal_parser"
    ]
  },
  "agent/tool_jail.py": {
    "summary": "This file defines tools and validates that agents use the correct tools for their current persona (either CODER or REVIEWER) and that they provide the required parameters for each tool.",
    "functions": [
      {
        "name": "validate_tool",
        "start": 19,
        "end": 32
      }
    ],
    "classes": [],
    "imports": []
  },
  "agent/decide.py": {
    "summary": "This file contains the `decide_next_action` function, which generates a prompt for an AI language model to decide the next action based on the current state of the system, including the phase, action history, observations, plan, and working memory.",
    "functions": [
      {
        "name": "decide_next_action",
        "start": 7,
        "end": 93
      }
    ],
    "classes": [],
    "imports": [
      "agent.llm",
      "agent.logger",
      "call_llm",
      "json",
      "log",
      "re"
    ]
  },
  "agent/planner.py": {
    "summary": "This file contains a function `make_plan` that generates a step-by-step plan based on a given goal and repository context, using an AI language model to analyze the goal and provide a structured plan in JSON format.",
    "functions": [
      {
        "name": "make_plan",
        "start": 7,
        "end": 46
      }
    ],
    "classes": [],
    "imports": [
      "agent.llm",
      "agent.logger",
      "call_llm",
      "json",
      "log",
      "re",
      "search_repo",
      "tools.repo_search"
    ]
  },
  "agent/approval.py": {
    "summary": "This file contains a function `ask_user_approval` that pauses a worker thread, displays an approval dialogue, and waits for user input to either approve or reject a code change.",
    "functions": [
      {
        "name": "ask_user_approval",
        "start": 3,
        "end": 28
      }
    ],
    "classes": [],
    "imports": [
      "agent.logger"
    ]
  },
  "agent/logger.py": {
    "summary": "This file defines a logging system that outputs logs to both a file and a user interface, with different formatting for each output.",
    "functions": [
      {
        "name": "emit",
        "start": 11,
        "end": 16
      },
      {
        "name": "setup_logger",
        "start": 18,
        "end": 34
      }
    ],
    "classes": [
      {
        "name": "TUILogHandler",
        "start": 10,
        "end": 16
      }
    ],
    "imports": [
      "logging",
      "queue",
      "sys"
    ]
  },
  "agent/loop.py": {
    "summary": "This file contains functions for detecting functions from a goal, rewriting functions based on a given state and code, and running an agent to manage the code editing process.",
    "functions": [
      {
        "name": "_detect_function_from_goal",
        "start": 19,
        "end": 26
      },
      {
        "name": "_rewrite_function",
        "start": 28,
        "end": 122
      },
      {
        "name": "run_agent",
        "start": 124,
        "end": 252
      }
    ],
    "classes": [],
    "imports": [
      "AND",
      "Path",
      "agent.approval",
      "agent.decide",
      "agent.llm",
      "agent.logger",
      "agent.planner",
      "agent.tool_jail",
      "ask_user_approval",
      "call_llm",
      "check_syntax",
      "decide_next_action",
      "find_function",
      "load_function_slice",
      "log",
      "make_plan",
      "parse_search_replace",
      "pathlib",
      "re",
      "read_file",
      "runtime",
      "search_repo",
      "state",
      "time",
      "tools.code_slice",
      "tools.diff_engine",
      "tools.fs_tools",
      "tools.function_locator",
      "tools.repo_search",
      "tools.universal_parser",
      "validate_tool"
    ]
  },
  "agent/llm.py": {
    "summary": "This file defines a function `call_llm` that sends a prompt to a local language model server and returns the response.",
    "functions": [
      {
        "name": "call_llm",
        "start": 10,
        "end": 42
      }
    ],
    "classes": [],
    "imports": [
      "agent.logger",
      "json",
      "log",
      "requests"
    ]
  },
  "agent/repo.py": {
    "summary": "This file defines a function `build_repo_summary` that generates a summary of files in a repository, listing up to a specified maximum number of files, excluding files within the `.git` directory.",
    "functions": [
      {
        "name": "build_repo_summary",
        "start": 3,
        "end": 13
      }
    ],
    "classes": [],
    "imports": [
      "Path",
      "pathlib"
    ]
  },
  "tui/app.py": {
    "summary": "This file defines a Textual User Interface (TUI) for an application called Operon, which allows users to interact with an agent for software engineering tasks, including code approval and diff preview.",
    "functions": [
      {
        "name": "__init__",
        "start": 18,
        "end": 22
      },
      {
        "name": "compose",
        "start": 24,
        "end": 30
      },
      {
        "name": "on_mount",
        "start": 32,
        "end": 40
      },
      {
        "name": "on_button_pressed",
        "start": 42,
        "end": 47
      },
      {
        "name": "compose",
        "start": 66,
        "end": 74
      },
      {
        "name": "on_mount",
        "start": 76,
        "end": 87
      },
      {
        "name": "_background_index",
        "start": 89,
        "end": 96
      },
      {
        "name": "on_key",
        "start": 99,
        "end": 107
      },
      {
        "name": "on_input_submitted",
        "start": 109,
        "end": 122
      },
      {
        "name": "execute_agent",
        "start": 124,
        "end": 128
      },
      {
        "name": "safe_update_log",
        "start": 130,
        "end": 131
      },
      {
        "name": "_write_to_log",
        "start": 133,
        "end": 134
      },
      {
        "name": "safe_show_diff",
        "start": 136,
        "end": 137
      },
      {
        "name": "_render_approval_ui",
        "start": 139,
        "end": 147
      },
      {
        "name": "resolve_approval",
        "start": 149,
        "end": 163
      }
    ],
    "classes": [
      {
        "name": "DiffApproval",
        "start": 16,
        "end": 47
      },
      {
        "name": "OperonUI",
        "start": 49,
        "end": 163
      }
    ],
    "imports": [
      "AgentState",
      "App",
      "Group",
      "Header",
      "Horizontal",
      "Key",
      "Panel",
      "Syntax",
      "Text",
      "agent.logger",
      "agent.loop",
      "cast",
      "index_repo",
      "os",
      "rich.console",
      "rich.panel",
      "rich.syntax",
      "rich.text",
      "run_agent",
      "runtime.state",
      "sys",
      "textual.app",
      "textual.containers",
      "textual.events",
      "textual.widgets",
      "tools.semantic_memory",
      "typing"
    ]
  },
  "runtime/state.py": {
    "summary": "This file defines a data class `AgentState` to represent the state of an agent in a multi-agent system, including its goals, current phase, plan, and various logs and counters.",
    "functions": [],
    "classes": [
      {
        "name": "AgentState",
        "start": 5,
        "end": 24
      }
    ],
    "imports": [
      "List",
      "dataclass",
      "dataclasses",
      "typing"
    ]
  }
}